<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/src/img/icons/logo-icon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/galleryPage/galleryPage.scss">
    <title>Орехи Причерноморья</title>
  </head>
  <body>
    <div class="wrapper">
      {{> _header }}
      <main>
        {{> breadcrumb firstPage = "Главная" secondPage = "Галерея " secondClass="breadscrum-banner"}}
        {{> customersPage/_customerPageBanner additionalClass='gallery-page-banner'  title="Галерея" subtitle="Кадры социальной активности компании" }}
       {{> galleryPage/_galleryPageGallery}}
        
        {{>_map}}
      </main>
      {{> _footer }}
    </div>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
  const lazyElements = document.querySelectorAll('.lazy');

  if ('IntersectionObserver' in window) {
    let lazyObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let lazyElement = entry.target;

          // Проверяем тип элемента и заменяем data-src на src
          if (lazyElement.tagName === 'IMG') {
            lazyElement.src = lazyElement.dataset.src;
          } else if (lazyElement.tagName === 'IFRAME') {
            lazyElement.src = lazyElement.dataset.src;
          } else if (lazyElement.tagName === 'VIDEO') {
            lazyElement.src = lazyElement.dataset.src;
            lazyElement.load();
          }

          lazyElement.classList.add('lazy-loaded');
          lazyObserver.unobserve(lazyElement);
        }
      });
    });

    lazyElements.forEach(function(lazyElement) {
      lazyObserver.observe(lazyElement);
    });
  } else {
    // Fallback для браузеров без поддержки IntersectionObserver
    let lazyLoadThrottleTimeout;
    function lazyLoad() {
      if (lazyLoadThrottleTimeout) {
        clearTimeout(lazyLoadThrottleTimeout);
      }

      lazyLoadThrottleTimeout = setTimeout(function() {
        let scrollTop = window.pageYOffset;
        lazyElements.forEach(function(el) {
          if (el.offsetTop < (window.innerHeight + scrollTop)) {
            if (el.tagName === 'IMG') {
              el.src = el.dataset.src;
            } else if (el.tagName === 'IFRAME') {
              el.src = el.dataset.src;
            } else if (el.tagName === 'VIDEO') {
              el.src = el.dataset.src;
              el.load();
            }
            el.classList.add('lazy-loaded');
          }
        });
        if (lazyElements.length === 0) {
          document.removeEventListener("scroll", lazyLoad);
          window.removeEventListener("resize", lazyLoad);
          window.removeEventListener("orientationchange", lazyLoad);
        }
      }, 20);
    }

    document.addEventListener("scroll", lazyLoad);
    window.addEventListener("resize", lazyLoad);
    window.addEventListener("orientationchange", lazyLoad);
  }
});
    </script>
    <script type="module" src="/src/js/lazy.js"></script>
    <script type="module" src="/galleryPage/galleryPage.js"></script>
    
  </body>
</html>
